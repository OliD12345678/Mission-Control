<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mission Control</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --wood-dark: #7a5228;
      --wood:      #b8905a;
      --wall:      #f2ebe0;
      --wall2:     #e4d8c4;
      --floor:     #d9c9aa;
      --floor2:    #c8b494;
      --carpet:    #b8a882;
      --desk:      #ede0c4;
      --desk-s:    #c8b090;
      --shadow:    rgba(60,40,10,.14);
      --card:      rgba(255,252,246,.96);
      --hal:    #2d6fd4;
      --dwight: #d4782a;
      --pam:    #c4508a;
      --kelly:  #8e44ad;
      --leslie: #1a9850;
      --tom:    #d42d2d;
    }
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Nunito',sans-serif;background:#ddd0b8;min-height:100vh;}

    /* TOP BAR */
    .topbar{
      background:var(--wood-dark);color:#fff;
      display:flex;align-items:center;justify-content:space-between;
      padding:10px 22px;box-shadow:0 3px 12px var(--shadow);
      position:sticky;top:0;z-index:400;
    }
    .topbar h1{font-size:1.35rem;font-weight:900;letter-spacing:3px;text-transform:uppercase;}
    .live-dot{width:9px;height:9px;border-radius:50%;background:#4ade80;display:inline-block;margin-right:7px;animation:lp 1.5s infinite;}
    @keyframes lp{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(1.5)}}
    .clock{font-family:'Space Mono',monospace;font-size:.9rem;}

    /* LAYOUT */
    .layout{display:grid;grid-template-columns:1fr 300px;gap:16px;padding:16px;max-width:1600px;margin:0 auto;}
    .left-col,.right-col{display:flex;flex-direction:column;gap:16px;}

    /* PANEL */
    .panel{background:var(--card);border-radius:14px;box-shadow:0 4px 18px var(--shadow);overflow:hidden;}
    .ph{background:var(--wood);color:#fff;font-weight:800;font-size:.7rem;letter-spacing:2.5px;text-transform:uppercase;padding:8px 14px;}

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FLOOR PLAN â€” TRUE TOP-DOWN
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .fp-wrap{background:#c4b898;border-radius:14px;overflow:hidden;box-shadow:0 4px 22px var(--shadow);}
    .fp-hdr{background:var(--wood-dark);color:#fff;font-weight:800;font-size:.7rem;letter-spacing:2.5px;text-transform:uppercase;padding:8px 14px;}

    /* The actual floor plan canvas */
    #fp{
      position:relative;
      width:100%;
      height:600px;
      overflow:hidden;
      /* Flat top-down look â€” no perspective transform */
      background:var(--floor);
    }

    /* Floor tiles */
    #fp::before{
      content:'';position:absolute;inset:0;
      background:
        repeating-conic-gradient(var(--floor) 0% 25%, var(--floor2) 0% 50%) 0 0 / 48px 48px;
      opacity:.55;
    }

    /* Outer walls */
    .wall-n,.wall-s,.wall-e,.wall-w{position:absolute;background:#a08060;z-index:2;}
    .wall-n{top:0;left:0;right:0;height:14px;box-shadow:0 3px 8px rgba(0,0,0,.18);}
    .wall-s{bottom:0;left:0;right:0;height:14px;box-shadow:0 -3px 8px rgba(0,0,0,.18);}
    .wall-w{top:0;left:0;bottom:0;width:14px;box-shadow:3px 0 8px rgba(0,0,0,.18);}
    .wall-e{top:0;right:0;bottom:0;width:14px;box-shadow:-3px 0 8px rgba(0,0,0,.18);}

    /* Inner divider wall (HAL's office) */
    .wall-inner{position:absolute;background:#a08060;z-index:2;}

    /* Room labels */
    .room-label{
      position:absolute;z-index:3;
      font-size:.55rem;font-weight:900;letter-spacing:1.5px;text-transform:uppercase;
      color:rgba(80,55,20,.4);pointer-events:none;
      }

    /* Carpet areas */
    .carpet{position:absolute;border-radius:6px;z-index:1;}

    /* Windows â€” top-down: just a lighter strip in the wall */
    .window{
      position:absolute;background:#c8e8f8;z-index:3;
      border:2px solid #90b8d0;
    }

    /* Door openings */
    .door{position:absolute;background:var(--floor);z-index:3;}
    .door::after{
      content:'';position:absolute;
      border:2px dashed rgba(120,80,30,.3);border-radius:0 0 100% 0;
    }

    /* â”€â”€ FURNITURE (top-down silhouettes) â”€â”€ */
    /* All furniture is flat rectangles/shapes as seen from above */
    .furn{position:absolute;z-index:10;border-radius:3px;}

    /* Desks â€” top-down rectangle with a monitor dot */
    .desk{
      position:absolute;z-index:10;
      background:var(--desk);
      border-radius:4px;
      border:2px solid var(--desk-s);
      box-shadow:0 2px 6px rgba(0,0,0,.14);
      display:flex;align-items:center;justify-content:center;
    }
    .desk .monitor-dot{
      width:28px;height:20px;
      background:#1a1a2e;border-radius:2px;
      border:1.5px solid #3a3a5e;
      position:relative;overflow:hidden;
      display:flex;align-items:center;justify-content:center;
    }
    .desk .monitor-dot::after{
      content:'';position:absolute;inset:2px;
      background:linear-gradient(135deg,#0a1628,#1a2a4a);
      animation:screenPulse 3s infinite;
    }
    @keyframes screenPulse{0%,100%{opacity:1}50%{opacity:.6}}

    /* Chair dots (top-down circles) */
    .chair{
      position:absolute;z-index:9;
      width:18px;height:18px;border-radius:50%;
      background:#c8a870;border:2px solid #a08050;
      box-shadow:0 1px 4px rgba(0,0,0,.15);
    }

    /* Sofa top-down */
    .sofa{
      position:absolute;z-index:10;
      background:#c0a878;border-radius:6px;
      border:2px solid #a08858;
      box-shadow:0 2px 6px rgba(0,0,0,.12);
    }

    /* Bookshelf top-down */
    .shelf{
      position:absolute;z-index:10;
      background:var(--wood);border-radius:3px;
      box-shadow:0 2px 5px rgba(0,0,0,.15);
      overflow:hidden;display:flex;
    }
    .shelf-spine{flex:1;height:100%;}

    /* Filing cabinet */
    .cabinet{position:absolute;z-index:10;background:#b0b8c0;border-radius:3px;border:2px solid #909898;box-shadow:0 2px 5px rgba(0,0,0,.14);}

    /* Water cooler top-down */
    .wcooler{
      position:absolute;z-index:10;
      width:22px;height:22px;border-radius:50%;
      background:radial-gradient(circle,#c8e8f8,#90c8e8);
      border:2px solid #60a0c0;
      box-shadow:0 1px 5px rgba(0,0,0,.15);
    }

    /* Plant top-down */
    .plant-td{
      position:absolute;z-index:10;
      border-radius:50%;
      background:radial-gradient(circle,#5a9e50,#3a7830);
      box-shadow:0 2px 6px rgba(0,0,0,.18);
    }

    /* Conference table */
    .conf-table{position:absolute;z-index:10;background:#d8c8a0;border-radius:12px;border:2px solid #b8a880;box-shadow:0 2px 8px rgba(0,0,0,.14);}

    /* â”€â”€ AGENTS â”€â”€ */
    .agent{
      position:absolute;z-index:50;
      display:flex;flex-direction:column;align-items:center;gap:2px;
      cursor:pointer;
      /* smooth walking */
      transition:left 3s cubic-bezier(.4,0,.2,1), top 3s cubic-bezier(.4,0,.2,1);
    }

    /* The agent circle â€” top-down view looks like a colored dot with emoji */
    .a-circle{
      width:36px;height:36px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      font-size:1.1rem;
      box-shadow:0 3px 10px rgba(0,0,0,.25);
      border:3px solid rgba(255,255,255,.8);
      position:relative;
      transition:box-shadow .3s,transform .3s;
    }

    /* BUSY state â€” pulsing glow ring */
    .a-circle.busy{
      animation:busyRing 1s ease-in-out infinite;
    }
    @keyframes busyRing{
      0%,100%{box-shadow:0 0 0 0 currentColor,0 3px 10px rgba(0,0,0,.25);}
      50%{box-shadow:0 0 0 7px transparent,0 3px 10px rgba(0,0,0,.25);}
    }

    /* SLACKING â€” slow dim pulse */
    .a-circle.slacking{
      animation:slackPulse 3s ease-in-out infinite;
      opacity:.75;
    }
    @keyframes slackPulse{0%,100%{opacity:.75}50%{opacity:.45}}

    .a-name{
      background:rgba(255,255,255,.92);border-radius:6px;padding:1px 6px;
      font-size:.55rem;font-weight:900;color:#3a2a1a;
      box-shadow:0 1px 4px var(--shadow);white-space:nowrap;
    }

    /* Busy dots under name */
    .bdots{display:flex;gap:2px;height:8px;align-items:flex-end;}
    .bd{width:4px;height:4px;border-radius:50%;animation:bdb 1s infinite;}
    .bd:nth-child(2){animation-delay:.2s}.bd:nth-child(3){animation-delay:.4s}
    @keyframes bdb{0%,100%{transform:translateY(0);opacity:.3}50%{transform:translateY(-4px);opacity:1}}
    .bdots.hidden{visibility:hidden;}

    /* Z indicator shadow = top-down depth illusion */
    .a-shadow{
      position:absolute;bottom:-6px;left:50%;transform:translateX(-50%);
      width:30px;height:8px;border-radius:50%;
      background:rgba(0,0,0,.18);filter:blur(3px);z-index:-1;
    }

    /* Bubble */
    .bubble{
      position:absolute;z-index:60;pointer-events:none;
      background:#fff;border-radius:10px 10px 10px 3px;
      padding:5px 8px;font-size:.58rem;font-weight:700;color:#3a2a1a;
      box-shadow:0 2px 10px var(--shadow);max-width:120px;line-height:1.3;
      transition:opacity .4s;
      white-space:normal;
    }
    .bubble::after{content:'';position:absolute;bottom:-6px;left:8px;border:5px solid transparent;border-top-color:#fff;}

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       AGENT KEY
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .key-list{padding:8px;display:flex;flex-direction:column;gap:5px;}
    .key-item{
      display:flex;align-items:center;gap:8px;
      background:#fdf6ec;border-radius:10px;padding:7px 10px;
      border-left:4px solid #ddd;cursor:pointer;transition:transform .15s;
    }
    .key-item:hover{transform:translateX(3px);}
    .key-av{width:26px;height:26px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.85rem;flex-shrink:0;}
    .key-info{flex:1;min-width:0;}
    .key-name{font-weight:900;font-size:.74rem;}
    .key-loc{font-size:.6rem;color:#9a8a7a;}
    .key-doing{font-size:.65rem;font-weight:700;color:#4a3a2a;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:140px;}
    .key-badge{font-size:.56rem;font-weight:900;text-transform:uppercase;letter-spacing:.5px;padding:3px 7px;border-radius:20px;white-space:nowrap;flex-shrink:0;}
    .b-busy   {background:#e8f5e8;color:#1a9850;}
    .b-slack  {background:#fff3e0;color:#e67e22;}
    .b-hal-busy{background:#e8f0ff;color:#2d6fd4;}

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TASKS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .task-form{padding:10px;display:flex;flex-direction:column;gap:6px;}
    .task-form input,.task-form select{
      border:2px solid #e8d8c0;border-radius:8px;padding:7px 10px;
      font-family:'Nunito',sans-serif;font-size:.8rem;font-weight:700;
      color:#3a2a1a;background:#fdf6ec;outline:none;transition:border-color .2s;
    }
    .task-form input:focus{border-color:var(--hal);}
    .btn-add{
      background:linear-gradient(135deg,#2d6fd4,#1a4fa0);color:#fff;border:none;
      border-radius:8px;padding:7px;font-family:'Nunito',sans-serif;
      font-weight:900;font-size:.8rem;cursor:pointer;transition:transform .15s,box-shadow .15s;
    }
    .btn-add:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(45,111,212,.35);}
    .task-list{padding:0 10px 10px;display:flex;flex-direction:column;gap:5px;max-height:190px;overflow-y:auto;}
    .task-item{
      background:#fdf6ec;border-radius:8px;padding:6px 9px;
      display:flex;align-items:center;gap:6px;
      font-size:.76rem;font-weight:700;color:#3a2a1a;
      border-left:4px solid #aaa;transition:transform .15s;
    }
    .task-item:hover{transform:translateX(2px);}
    .task-item.done{opacity:.5;text-decoration:line-through;}
    .task-item input[type=checkbox]{accent-color:#1a9850;cursor:pointer;}
    .t-badge{margin-left:auto;font-size:.58rem;padding:2px 6px;border-radius:5px;font-weight:800;white-space:nowrap;}
    .btn-del{background:none;border:none;cursor:pointer;color:#c07060;font-size:.72rem;opacity:.4;transition:opacity .2s;}
    .btn-del:hover{opacity:1;}

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CALENDAR
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .cal-wrap{padding:10px;}
    .cal-nav{display:flex;align-items:center;justify-content:space-between;margin-bottom:7px;}
    .cal-nav span{font-weight:900;font-size:.82rem;color:#3a2a1a;}
    .cal-nav button{background:#f0e0c8;border:none;cursor:pointer;font-weight:900;font-size:.88rem;width:25px;height:25px;border-radius:6px;color:var(--wood-dark);transition:background .15s;}
    .cal-nav button:hover{background:#e0c8a8;}
    .cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:2px;text-align:center;}
    .cal-lbl{font-size:.56rem;font-weight:900;color:#8a7a6a;text-transform:uppercase;padding:2px 0;}
    .cal-d{font-size:.7rem;font-weight:700;padding:5px 2px;border-radius:6px;cursor:pointer;color:#3a2a1a;transition:background .15s;position:relative;}
    .cal-d:hover{background:#f0e0c8;}
    .cal-d.today{background:var(--hal);color:#fff;}
    .cal-d.has-task::after{content:'';position:absolute;bottom:2px;left:50%;transform:translateX(-50%);width:3px;height:3px;border-radius:50%;background:#d42d2d;}
    .cal-d.dim{color:#c0b0a0;}
  </style>
</head>
<body>

<div class="topbar">
  <h1>ğŸ›¸ Mission Control</h1>
  <div><span class="live-dot"></span><span class="clock" id="clk">--:--:--</span></div>
</div>

<div class="layout">
 <div class="left-col">

  <div class="fp-wrap">
    <div class="fp-hdr">ğŸ¢ Floor Plan â€” Live View</div>
    <div id="fp">

      <!-- OUTER WALLS -->
      <div class="wall-n"></div><div class="wall-s"></div>
      <div class="wall-w"></div><div class="wall-e"></div>

      <!-- HAL'S CORNER OFFICE divider walls -->
      <!-- Vertical wall from top, with a door gap -->
      <div class="wall-inner" style="left:200px;top:14px;width:10px;height:155px;"></div>
      <!-- Horizontal wall -->
      <div class="wall-inner" style="left:14px;top:170px;width:196px;height:10px;"></div>
      <!-- Door gap label -->
      <div class="door" style="left:14px;top:140px;width:30px;height:30px;"></div>

      <!-- Room labels -->
      <div class="room-label" style="left:24px;top:20px;">HAL's Office</div>
      <div class="room-label" style="left:240px;top:20px;">Main Floor</div>
      <div class="room-label" style="left:24px;top:240px;">Break Area</div>
      <div class="room-label" style="left:55%;top:72%;transform:translateX(-50%)">Community Zone</div>

      <!-- CARPETS -->
      <!-- HAL office carpet -->
      <div class="carpet" style="left:16px;top:16px;width:178px;height:148px;background:rgba(45,111,212,.08);"></div>
      <!-- Main floor carpet -->
      <div class="carpet" style="left:212px;top:16px;right:16px;bottom:16px;background:rgba(185,160,120,.12);border-radius:4px;"></div>
      <!-- Break area carpet -->
      <div class="carpet" style="left:16px;top:182px;width:178px;height:160px;background:rgba(180,140,80,.12);border-radius:4px;"></div>
      <!-- Community rug -->
      <div class="carpet" style="left:35%;top:55%;width:36%;height:22%;background:rgba(160,120,70,.18);border-radius:10px;"></div>

      <!-- WINDOWS (top-down light strips in north wall) -->
      <div class="window" style="left:250px;top:2px;width:80px;height:12px;"></div>
      <div class="window" style="left:380px;top:2px;width:80px;height:12px;"></div>
      <div class="window" style="left:510px;top:2px;width:80px;height:12px;"></div>
      <!-- West wall windows -->
      <div class="window" style="left:2px;top:60px;width:12px;height:50px;"></div>

      <!-- â”€â”€ HAL'S OFFICE FURNITURE â”€â”€ -->
      <!-- HAL's L-shaped desk (two pieces) -->
      <div class="desk" style="left:30px;top:30px;width:110px;height:50px;">
        <div class="monitor-dot"></div>
      </div>
      <div class="desk" style="left:120px;top:70px;width:50px;height:80px;"></div>
      <!-- HAL chair -->
      <div class="chair" style="left:75px;top:88px;"></div>
      <!-- HAL bookshelf on wall -->
      <div class="shelf" style="left:16px;top:100px;width:12px;height:60px;flex-direction:column;">
        <div class="shelf-spine" style="background:#e74c3c;"></div>
        <div class="shelf-spine" style="background:#3498db;"></div>
        <div class="shelf-spine" style="background:#2ecc71;"></div>
        <div class="shelf-spine" style="background:#f39c12;"></div>
      </div>
      <!-- HAL plant -->
      <div class="plant-td" style="left:158px;top:22px;width:28px;height:28px;"></div>
      <!-- HAL cabinet -->
      <div class="cabinet" style="left:168px;top:60px;width:24px;height:60px;"></div>

      <!-- â”€â”€ BREAK AREA â”€â”€ -->
      <!-- Water cooler -->
      <div class="wcooler" style="left:40px;top:200px;"></div>
      <!-- Sofa -->
      <div class="sofa" style="left:22px;top:240px;width:100px;height:30px;"></div>
      <div class="sofa" style="left:22px;top:272px;width:30px;height:60px;border-radius:6px 6px 6px 6px;"></div>
      <!-- Small coffee table -->
      <div class="furn" style="left:68px;top:255px;width:40px;height:30px;background:#c8b890;border:2px solid #a89870;border-radius:4px;"></div>
      <!-- Break area plant -->
      <div class="plant-td" style="left:160px;top:188px;width:22px;height:22px;"></div>
      <div class="plant-td" style="left:160px;top:310px;width:18px;height:18px;"></div>

      <!-- â”€â”€ MAIN FLOOR â”€â”€ -->

      <!-- DWIGHT desk (dedicated, top area) -->
      <div class="desk" style="left:240px;top:30px;width:90px;height:50px;">
        <div class="monitor-dot"></div>
      </div>
      <div class="chair" style="left:270px;top:84px;"></div>
      <!-- Cabinet by Dwight -->
      <div class="cabinet" style="left:340px;top:30px;width:20px;height:50px;"></div>

      <!-- Community desk cluster (center) -->
      <!-- Long shared table -->
      <div class="desk" style="left:38%;top:57%;width:130px;height:55px;">
        <div class="monitor-dot" style="margin-right:8px;"></div>
        <div class="monitor-dot"></div>
      </div>
      <!-- Chairs around community desk -->
      <div class="chair" style="left:40%;top:calc(57% - 22px);"></div>
      <div class="chair" style="left:calc(40% + 40px);top:calc(57% - 22px);"></div>
      <div class="chair" style="left:40%;top:calc(57% + 60px);"></div>
      <div class="chair" style="left:calc(40% + 40px);top:calc(57% + 60px);"></div>

      <!-- Printer / copier -->
      <div class="furn" style="right:30px;top:30px;width:50px;height:40px;background:#b0b8c0;border:2px solid #909898;border-radius:3px;display:flex;align-items:center;justify-content:center;font-size:.5rem;color:#606870;font-weight:900;">PRINT</div>

      <!-- East wall shelving -->
      <div class="shelf" style="right:16px;top:80px;width:12px;height:120px;flex-direction:column;">
        <div class="shelf-spine" style="background:#9b59b6;"></div>
        <div class="shelf-spine" style="background:#e74c3c;"></div>
        <div class="shelf-spine" style="background:#1abc9c;"></div>
        <div class="shelf-spine" style="background:#3498db;"></div>
        <div class="shelf-spine" style="background:#e67e22;"></div>
      </div>

      <!-- Plants on main floor -->
      <div class="plant-td" style="right:30px;bottom:120px;width:26px;height:26px;"></div>
      <div class="plant-td" style="left:220px;bottom:20px;width:20px;height:20px;"></div>
      <div class="plant-td" style="right:100px;bottom:20px;width:22px;height:22px;"></div>

      <!-- Conference / meeting area bottom right -->
      <div class="conf-table" style="right:60px;bottom:50px;width:100px;height:60px;"></div>
      <div class="chair" style="right:95px;bottom:116px;"></div>
      <div class="chair" style="right:55px;bottom:116px;"></div>
      <div class="chair" style="right:135px;bottom:80px;"></div>
      <div class="chair" style="right:30px;bottom:80px;"></div>
      <div class="chair" style="right:95px;bottom:44px;"></div>
      <div class="chair" style="right:55px;bottom:44px;"></div>

      <!-- â”€â”€ AGENTS (JS-controlled) â”€â”€ -->
      <div id="agents"></div>

    </div><!-- /#fp -->
  </div>

 </div><!-- /left-col -->

 <div class="right-col">

  <!-- AGENT KEY -->
  <div class="panel">
    <div class="ph">ğŸ—ºï¸ Agent Status</div>
    <div class="key-list" id="agentKey"></div>
  </div>

  <!-- TASKS -->
  <div class="panel">
    <div class="ph">âœ… Tasks Board</div>
    <div class="task-form">
      <input type="text" id="taskInput" placeholder="Task title..."/>
      <select id="taskAssignee">
        <option>HAL</option><option>Dwight</option><option>Pam</option>
        <option>Kelly</option><option>Leslie</option><option>Tom</option>
      </select>
      <button class="btn-add" onclick="addTask()">+ Add Task</button>
    </div>
    <div class="task-list" id="taskList"></div>
  </div>

  <!-- CALENDAR -->
  <div class="panel">
    <div class="ph">ğŸ“… Calendar</div>
    <div class="cal-wrap">
      <div class="cal-nav">
        <button onclick="changeMonth(-1)">â€¹</button>
        <span id="calLabel"></span>
        <button onclick="changeMonth(1)">â€º</button>
      </div>
      <div class="cal-grid" id="calGrid"></div>
    </div>
  </div>

 </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AGENT CONFIG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Positions are % of floor plan width/height (left/top)
const AGENTS = [
  { id:'hal',    name:'HAL',    emoji:'ğŸ¤–', color:'#2d6fd4', fixed:true,
    homeL:7, homeT:40 },   // sits at his desk
  { id:'dwight', name:'Dwight', emoji:'ğŸ¦¾', color:'#d4782a', fixed:true,
    homeL:36, homeT:12 },  // sits at his desk
  { id:'pam',    name:'Pam',    emoji:'ğŸ‘©', color:'#c4508a', fixed:false,
    homeL:50, homeT:50 },
  { id:'kelly',  name:'Kelly',  emoji:'ğŸ’…', color:'#8e44ad', fixed:false,
    homeL:30, homeT:62 },
  { id:'leslie', name:'Leslie', emoji:'ğŸ“‹', color:'#1a9850', fixed:false,
    homeL:48, homeT:68 },
  { id:'tom',    name:'Tom',    emoji:'ğŸ•´ï¸', color:'#d42d2d', fixed:false,
    homeL:65, homeT:44 },
];

// Roaming waypoints (% left, % top)
const WAYPOINTS = [
  // break area / water cooler
  {l:8, t:37},{l:10,t:42},{l:12,t:48},
  // community desk zone
  {l:40,t:60},{l:46,t:65},{l:52,t:58},{l:55,t:70},
  // main floor open areas
  {l:60,t:35},{l:70,t:50},{l:75,t:65},{l:65,t:75},
  {l:50,t:80},{l:35,t:78},{l:28,t:55},{l:32,t:70},
  // conference area
  {l:75,t:78},{l:80,t:72},{l:72,t:82},
  // near printer
  {l:82,t:18},{l:78,t:25},
  // general wandering
  {l:55,t:45},{l:48,t:30},{l:62,t:28},
];

// Messages
const MSGS = {
  hal:    ['Managing queue ğŸ“‹','Monitoring agents ğŸ‘ï¸','Delegating tasks ğŸ“¤','Reviewing metrics ğŸ“Š','System check âœ…'],
  dwight: ['Running analysis ğŸ“Š','Executing tasks âš™ï¸','Scanning anomalies ğŸ”','Reporting to HAL ğŸ“¡','Processing data ğŸ§®'],
  pam:    ['Sorting messages ğŸ“¬','Filing docs ğŸ“‚','Scheduling calls ğŸ“','Inbox zero hunt ğŸ“§','Making coffee â˜•'],
  kelly:  ['Chatting ğŸ’¬','Checking news ğŸ“±','Sharing updates ğŸ—£ï¸','Planning lunch ğŸ¥—','Team check-in ğŸ˜Š'],
  leslie: ['Writing report ğŸ“','Building binder ğŸ“’','Researching ğŸ”','Writing proposals âœï¸','Cross-referencing ğŸ“‘'],
  tom:    ['Pitching ideas ğŸ’¡','Networking ğŸ“²','Brainstorming ğŸ¯','Closing deals ğŸ’¼','Trend spotting ğŸŒ'],
};
const SLACK = ['ğŸ˜´ Slacking','ğŸ¥± Doing nothing','ğŸ“± Scrolling phone','ğŸ’­ Daydreaming','ğŸƒ Solitaire','ğŸ˜¶ Zoning out'];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let agentPos  = {};  // {id: {l, t}}
let agentMsg  = {};  // {id: string}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STORAGE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getTasks(){ try{return JSON.parse(localStorage.getItem('mc5')||'[]');}catch(e){return[];} }
function saveTasks(t){ localStorage.setItem('mc5', JSON.stringify(t)); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BUILD AGENT ELEMENTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildAgents(){
  const c = document.getElementById('agents');
  c.innerHTML = '';
  AGENTS.forEach(a => {
    agentPos[a.id] = {l: a.homeL, t: a.homeT};
    agentMsg[a.id] = MSGS[a.id][0];

    const el = document.createElement('div');
    el.className = 'agent';
    el.id = 'ag-' + a.id;
    el.style.left   = a.homeL + '%';
    el.style.top    = a.homeT + '%';
    el.onclick = () => pingAgent(a.id);
    el.innerHTML = `
      <div class="bubble" id="bub-${a.id}" style="bottom:44px;left:50%;transform:translateX(-40%)">${agentMsg[a.id]}</div>
      <div class="a-shadow"></div>
      <div class="a-circle" id="circ-${a.id}" style="background:linear-gradient(135deg,${a.color},${darker(a.color)});color:${a.color}">${a.emoji}</div>
      <div class="a-name">${a.name}</div>
      <div class="bdots hidden" id="dots-${a.id}">
        <div class="bd" style="background:${a.color}"></div>
        <div class="bd" style="background:${a.color}"></div>
        <div class="bd" style="background:${a.color}"></div>
      </div>`;
    c.appendChild(el);
  });
}

function darker(hex){
  const r=parseInt(hex.slice(1,3),16),g=parseInt(hex.slice(3,5),16),b=parseInt(hex.slice(5,7),16);
  return `rgb(${Math.max(0,r-55)},${Math.max(0,g-55)},${Math.max(0,b-55)})`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MOVEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function moveRoamers(){
  AGENTS.filter(a => !a.fixed).forEach(a => {
    const wp = WAYPOINTS[Math.floor(Math.random() * WAYPOINTS.length)];
    const jL = (Math.random()-.5)*6;
    const jT = (Math.random()-.5)*6;
    const el = document.getElementById('ag-' + a.id);
    if(!el) return;
    const newL = Math.min(88, Math.max(2, wp.l + jL));
    const newT = Math.min(88, Math.max(2, wp.t + jT));
    el.style.left = newL + '%';
    el.style.top  = newT + '%';
    agentPos[a.id] = {l: newL, t: newT};
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BUSY / SLACK STATE UPDATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateAgentStates(){
  const tasks = getTasks();
  AGENTS.forEach(a => {
    const myTask = tasks.find(t => t.assignee === a.name && !t.done);
    const busy   = !!myTask;
    const circ   = document.getElementById('circ-' + a.id);
    const dots   = document.getElementById('dots-' + a.id);
    const bub    = document.getElementById('bub-'  + a.id);

    // pick message
    const pool = busy ? MSGS[a.id] : SLACK;
    const msg  = busy ? myTask.title : pool[Math.floor(Math.random()*pool.length)];
    agentMsg[a.id] = msg;

    if(circ){
      circ.classList.toggle('busy',    busy);
      circ.classList.toggle('slacking', !busy);
    }
    if(dots) dots.classList.toggle('hidden', !busy);

    if(bub){
      bub.style.opacity = 0;
      setTimeout(()=>{
        bub.textContent = busy ? ('ğŸ”¨ ' + msg) : msg;
        bub.style.transition = 'opacity .4s';
        bub.style.opacity = 1;
      },300);
    }
  });
  renderKey();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PING (click glow)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function pingAgent(id){
  const a  = AGENTS.find(x=>x.id===id);
  const el = document.getElementById('ag-'+id);
  if(!el||!a) return;
  el.style.filter = `drop-shadow(0 0 14px ${a.color})`;
  setTimeout(()=>el.style.filter='', 1000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AGENT KEY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const LOC = {
  hal:'Corner Office', dwight:'Dedicated Desk',
  pam:'Roaming', kelly:'Break Area / Cooler',
  leslie:'Community Desk', tom:'Roaming',
};

function renderKey(){
  const tasks = getTasks();
  document.getElementById('agentKey').innerHTML = AGENTS.map(a=>{
    const myTask = tasks.find(t=>t.assignee===a.name&&!t.done);
    const busy   = !!myTask;
    const doing  = busy ? myTask.title : (agentMsg[a.id]||SLACK[0]);
    const bcls   = busy ? (a.id==='hal'?'b-hal-busy':'b-busy') : 'b-slack';
    const btxt   = busy ? (a.id==='hal'?'HAL is busy':'Working') : 'Slacking';
    return `<div class="key-item" style="border-left-color:${a.color}" onclick="pingAgent('${a.id}')">
      <div class="key-av" style="background:${a.color}22">${a.emoji}</div>
      <div class="key-info">
        <div class="key-name" style="color:${a.color}">${a.name} <span style="font-weight:600;color:#9a8a7a;font-size:.58rem">Â· ${LOC[a.id]}</span></div>
        <div class="key-doing">${busy?'ğŸ”¨ ':''}${doing}</div>
      </div>
      <span class="key-badge ${bcls}">${btxt}</span>
    </div>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TASKS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const COLORS = {HAL:'#2d6fd4',Dwight:'#d4782a',Pam:'#c4508a',Kelly:'#8e44ad',Leslie:'#1a9850',Tom:'#d42d2d'};

function addTask(){
  const inp = document.getElementById('taskInput');
  const asgn = document.getElementById('taskAssignee').value;
  const title = inp.value.trim();
  if(!title) return;
  const t = getTasks();
  t.unshift({id:Date.now(),title,assignee:asgn,done:false});
  saveTasks(t); inp.value='';
  renderTasks(); updateAgentStates(); renderCal();
}

function toggleTask(id){
  saveTasks(getTasks().map(t=>t.id===id?{...t,done:!t.done}:t));
  renderTasks(); updateAgentStates();
}

function deleteTask(id){
  saveTasks(getTasks().filter(t=>t.id!==id));
  renderTasks(); updateAgentStates(); renderCal();
}

function renderTasks(){
  const tasks = getTasks();
  const list  = document.getElementById('taskList');
  if(!tasks.length){
    list.innerHTML='<div style="text-align:center;color:#b0a080;font-size:.74rem;padding:10px">No tasks â€” everyone is slacking! ğŸ˜´</div>';
    return;
  }
  list.innerHTML = tasks.map(t=>`
    <div class="task-item${t.done?' done':''}" style="border-left-color:${COLORS[t.assignee]||'#aaa'}">
      <input type="checkbox" ${t.done?'checked':''} onchange="toggleTask(${t.id})"/>
      <span>${t.title}</span>
      <span class="t-badge" style="background:${COLORS[t.assignee]||'#aaa'}22;color:${COLORS[t.assignee]||'#888'}">${t.assignee}</span>
      <button class="btn-del" onclick="deleteTask(${t.id})">âœ•</button>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CALENDAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let calDate = new Date();
const TODAY = new Date();
function renderCal(){
  const y=calDate.getFullYear(),m=calDate.getMonth();
  document.getElementById('calLabel').textContent=calDate.toLocaleString('default',{month:'long',year:'numeric'});
  const first=new Date(y,m,1).getDay(),days=new Date(y,m+1,0).getDate(),prev=new Date(y,m,0).getDate();
  const tasks=getTasks();
  let h=['Su','Mo','Tu','We','Th','Fr','Sa'].map(l=>`<div class="cal-lbl">${l}</div>`).join('');
  for(let i=first-1;i>=0;i--) h+=`<div class="cal-d dim">${prev-i}</div>`;
  for(let d=1;d<=days;d++){
    const isT=d===TODAY.getDate()&&m===TODAY.getMonth()&&y===TODAY.getFullYear();
    const hasT=tasks.some(t=>{const td=new Date(t.id);return td.getDate()===d&&td.getMonth()===m&&td.getFullYear()===y;});
    h+=`<div class="cal-d${isT?' today':''}${hasT?' has-task':''}">${d}</div>`;
  }
  for(let d=1;d<=42-first-days;d++) h+=`<div class="cal-d dim">${d}</div>`;
  document.getElementById('calGrid').innerHTML=h;
}
function changeMonth(d){calDate.setMonth(calDate.getMonth()+d);renderCal();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CLOCK + INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
setInterval(()=>document.getElementById('clk').textContent=new Date().toLocaleTimeString(),1000);

buildAgents();
renderTasks();
updateAgentStates();
renderCal();

// Roamers walk every 7s
moveRoamers();
setInterval(moveRoamers, 7000);

// State + messages refresh every 5s
setInterval(updateAgentStates, 5000);

document.getElementById('taskInput').addEventListener('keydown',e=>{if(e.key==='Enter')addTask();});
</script>
</body>
</html>
